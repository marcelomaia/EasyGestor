"Produto mais vendido por unidade: %s, %s un";select sellable.description as "Descricao", sum(sale_item.quantity) as "Quantidade" from sale_item inner join sellable on sale_item.sellable_id=sellable.id group by sellable.description order by "Quantidade" desc
"Produto mais vendido por cliente: %s, %s un";select sellable.description as "Descricao", count(sale_item.id) as "Quantidade" from sale_item inner join sellable on sale_item.sellable_id=sellable.id group by sellable.description order by "Quantidade" desc
"Cliente com mais compras: %s, %s vezes";select person.name as "Nome Cliente", count(sale.id) as "Quantidade Vendas" from sale inner join person_adapt_to_client on sale.client_id=person_adapt_to_client.original_id inner join person on person_adapt_to_client.original_id=person.id where sale.status in (0,1,2,4,6) group by "Nome Cliente" order by "Quantidade Vendas" desc
"Cliente com mais Valor Agregado: %s, R$ %s";select person.name as "Nome Cliente", sum(sale.total_amount) as "Total em Vendas" from sale inner join person_adapt_to_client on sale.client_id=person_adapt_to_client.original_id inner join person on person_adapt_to_client.original_id=person.id where sale.status in (0,1,2,4,6) group by "Nome Cliente" order by "Total em Vendas" desc
"Cliente Com maior Valor A pagar: %s, R$ %s";select name as "Cliente",sum(base_value) as "Debito" from payment inner join payment_group on payment.group_id=payment_group.id inner join person on payment_group.payer_id=person.id where payment.due_date < (localtimestamp - interval '30 days') and payment.status =1 group by name order by "Debito" desc